# File generated by Wizard 2.9.0 on Jun 24, 2025.

processor  WEAPON_RELEASE WSF_SCRIPT_PROCESSOR 
   update_interval  1 s
   script_variables 
      string weaponName = "";
      Map<string,bool> isEngage = Map<string,bool>();  
      int engagaCount = 5;
   end_script_variables
   
   script bool fireEnemy(WsfTrack tTrack, string wpName){
      bool isSuccess = false;
      WsfWeapon tempWeapon = PLATFORM.Weapon(wpName);
      if(tempWeapon.IsValid()
      && tempWeapon.QuantityRemaining()>0
      && PLATFORM.Altitude() > 9000
      && tempWeapon.AuxDataDouble("strikeDistance") > PLATFORM.GroundRangeTo(tTrack)){
        isSuccess = tempWeapon.FireSalvo(tTrack,1);
        writeln("T = ",TIME_NOW,",`",PLATFORM.Name() ,"`  launches the missile `",wpName,"` to bomb `", tTrack.TargetName(),"` with isSuccess = ",isSuccess);
      }
      return isSuccess;
   }
   end_script
   
   on_update 
      WsfLocalTrackList track_list = PLATFORM.MasterTrackList();
      int track_count = track_list.Count();
      for(int i = 0; i < engagaCount; i += 1 ){
         WsfTrack tTrack = track_list.TrackEntry(i);
         if(!tTrack.IsValid())continue;
         string track_name = tTrack.TargetName();
         if(isEngage[track_name])continue;
         if(!fireEnemy(tTrack,weaponName))continue;
            isEngage[track_name] = true;  
      }
   end_on_update
end_processor